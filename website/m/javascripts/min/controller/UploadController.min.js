/*global Package *//*global Import *//*global Class *//*global MjConfig *//*global UploadController */Package("controller",[Import("view.StatsView"),Class("public singleton UploadController",{_public_static:{EVENT_UPLOAD_START:"UploadController.Event.UploadStart",EVENT_UPLOAD_PROGRESS:"UploadController.Event.UploadProgress",EVENT_UPLOAD_COMPLETE:"UploadController.Event.UploadComplete"},_public:{$fileInput:null,fileId:-1,UploadController:function(){},init:function(e){var t=this;this.$fileInput=e;this.$fileInput.fileupload({dataType:"json",autoUpload:!0,add:function(e,n){alert("add");n.url=MjConfig.getInstance().uploadUrl+(window.googleAppEngineRuntime?"":"/index.php");n.submit();t.onUploadStart()},progress:function(e,n){alert("progress");t.onUploadProgress(n.loaded/n.total)},done:function(e,n){alert("done");t.fileId=n.result.result.id;t.onUploadComplete(n)}})},onUploadStart:function(){this.dispatch(UploadController.EVENT_UPLOAD_START)},onUploadProgress:function(e){this.dispatch(UploadController.EVENT_UPLOAD_PROGRESS,{progress:e})},onUploadComplete:function(e){this.dispatch(UploadController.EVENT_UPLOAD_COMPLETE,{id:e.result.result.id,url:e.result.result.uri})}}})]);