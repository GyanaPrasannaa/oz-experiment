/*global Poof *//*global Package *//*global Import *//*global Class *//*global GestureController *//*global Modernizr */Package("controller",[Import("util.TextUtil"),Class("public singleton GestureController",{_public_static:{EVENT_SCROLL_UP:"GestureController.Event.ScrollUp",EVENT_SCROLL_DOWN:"GestureController.Event.ScrollDown"},_public:{enabled:!1,startPos:{x:0,y:0},lastPos:{x:0,y:0},deltaPos:{x:0,y:0},absoluteDeltaPos:{x:0,y:0},dragging:!1,GestureController:function(){},enable:function(){this.enabled=!0;$(document).bind(Modernizr.touch?"touchstart.gesturecontroller":"mousedown.gesturecontroller",Poof.retainContext(this,this.onTouchStart));$(document).bind(Modernizr.touch?"touchend.gesturecontroller":"mouseup.gesturecontroller",Poof.retainContext(this,this.onTouchEnd));$(document).bind(Modernizr.touch?"touchmove.gesturecontroller":"mousemove.gesturecontroller",Poof.retainContext(this,this.onTouchMove))},disable:function(){this.enabled=!1;$(document).unbind("touchstart.gesturecontroller");$(document).unbind("touchend.gesturecontroller");$(document).unbind("touchmove.gesturecontroller");$(document).unbind("mousedown.gesturecontroller");$(document).unbind("mouseup.gesturecontroller");$(document).unbind("mousemove.gesturecontroller")},registerStartValues:function(e){var t=e.originalEvent;t.touches?this.startPos={x:t.touches[0].pageX,y:t.touches[0].pageY}:this.startPos={x:t.pageX,y:t.pageY};this.lastPos={x:this.startPos.x,y:this.lastPos.y}},registerEndValues:function(e){Poof.suppressUnused(e)},registerMoveValues:function(e){var t=e.originalEvent;if(t.touches){this.deltaPos={x:t.touches[0].pageX-this.lastPos.x,y:t.touches[0].pageY-this.lastPos.y};this.absoluteDeltaPos={x:t.touches[0].pageX-this.startPos.x,y:t.touches[0].pageY-this.startPos.y};this.lastPos={x:t.touches[0].pageX,y:t.touches[0].pageY}}else{this.deltaPos={x:t.pageX-this.lastPos.x,y:t.pageY-this.lastPos.y};this.lastPos={x:t.pageX,y:t.pageY}}},onTouchStart:function(e){this.registerStartValues(e);this.dragging=!0},onTouchEnd:function(e){this.dragging=!1;this.registerEndValues(e);this.applyMomentum()},onTouchMove:function(e){if(this.dragging){this.registerMoveValues(e);if(this.absoluteDeltaPos.y>GestureController.MIN_SWIPE_LENGTH){console.log("up");this.dispatch(GestureController.EVENT_SCROLL_UP)}else if(this.absoluteDeltaPos.y<-GestureController.MIN_SWIPE_LENGTH){console.log("down");this.dispatch(GestureController.EVENT_SCROLL_DOWN)}}}}})]);