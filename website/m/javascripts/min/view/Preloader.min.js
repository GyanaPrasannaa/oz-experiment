/*global Poof *//*global Package *//*global Load *//*global Import *//*global Class *//*global console */Package("view",[Import("mjframe.View"),Class("public singleton Preloader extends View",{_public_static:{SPINNER_ROTATION_SPEED:1.5},_public:{$spinner:null,$progress:null,spinnerRotation:0,lastFrameTime:0,Preloader:function(){this._super();this.init("preloader","view.PreloaderView","Preloader")},onReady:function(){this.$el.css("display","")},compile:function(){this._super();this.$spinner=$(".spinnerContainer");this.$progress=$(".preloaderContainer .text")},show:function(e){this.$container.fadeIn();this.startAnimation()},hide:function(e){this.stopAnimation();this.$container.fadeOut()},startAnimation:function(){AnimationController.getInstance().on(AnimationController.EVENT_FRAME,Poof.retainContext(this,this.onFrame))},stopAnimation:function(){AnimationController.getInstance().off(AnimationController.EVENT_FRAME)},setProgress:function(e){this.$progress&&this.$progress.text(Math.round(e).toString())},onFrame:function(e){this.$spinner&&this.$spinner.rotate(this.spinnerRotation+=e.data.deltaTime*Preloader.SPINNER_ROTATION_SPEED*360/1e3)}}})]);