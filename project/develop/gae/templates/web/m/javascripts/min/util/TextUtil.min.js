/*global Package *//*global Class *//*global TextUtil */Package("util",[Class("public singleton TextUtil",{_public_static:{CHECK_STEP:1,WHITE_SPACE_REGEXP:new RegExp("[ 	\r\n]")},_public:{TextUtil:function(){String.prototype.regexIndexOf=function(e,t){var n=this.substring(t||0).search(e);return n>=0?n+(t||0):n};String.prototype.regexLastIndexOf=function(e,t){e=e.global?e:new RegExp(e.source,"g"+(e.ignoreCase?"i":"")+(e.multiLine?"m":""));typeof t=="undefined"?t=this.length:t<0&&(t=0);var n=this.substring(0,t+1),r=-1,i=0,s;while((s=e.exec(n))!==null){r=s.index;e.lastIndex=++i}return r}},getNumLines:function(e){return e.height()/parseInt(e.css("line-height"),10)},getLine:function(e,t){var n=this.getNumLines(e);return t<n?this.getTextLines(e)[t]:null},getTextLines:function(e){var t=[],n=e.height()/parseInt(e.css("line-height"),10),r=$.trim(e.text()),i=r.length/n,s=0;for(var o=0;o<n;o++){var u=s+i,a=r.substring(s,u);if(a.length===0)break;e.text(a);var f=e.height()/parseInt(e.css("line-height"),10),l=TextUtil.CHECK_STEP,c=2,h=-TextUtil.CHECK_STEP;if(f>1){l=-l;c=1;h=0}while(f!==c&&u<r.length){u+=l;a=r.substring(s,u);e.text(a);f=e.height()/parseInt(e.css("line-height"),10)}u+=h;r.regexIndexOf(TextUtil.WHITE_SPACE_REGEXP,u)!==u&&u<r.length&&(u=r.substring(0,u).regexLastIndexOf(TextUtil.WHITE_SPACE_REGEXP));a=r.substring(s,u);s=u;t.push(a)}e.text(r);return t},breakIntoLines:function(e){var t=this.getTextLines(e),n=e.parent(),r=e.clone();e.remove();for(var i=0;i<t.length;i++){var s=r.clone();s.text(t[i]);n.append(s)}}}})]);